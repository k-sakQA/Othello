# ホテル予約サイト - 包括的テスト計画

**テスト対象URL**: https://hotel-example-site.takeyaqa.dev/ja/plans.html  
**作成日**: 2025年10月23日  
**テスト観点**: 23項目の品質特性ベース  
**テスト対象外**: ホームタブ

---

## Application Overview

### システム概要
ホテル予約システムは、ユーザーが宿泊プランの閲覧・選択から予約確認までを行えるWebアプリケーションです。

### 主要機能
- **プラン一覧表示** (`/ja/plans.html`)
- **予約フォーム** (`/ja/reserve.html?plan-id=X`)
- **予約確認画面**
- **ログイン機能**（利用可能）

### 既知のフォーム項目
- 宿泊日（日付入力）
- 宿泊数（数値入力、spinbutton）
- 人数（数値入力、spinbutton）
- 氏名（テキスト入力）
- 確認のご連絡方法（セレクトボックス）

---

## Test Scenarios

## 1. 表示（UI）テスト

### 1.1 レイアウト/文言確認
**テスト観点No.1**: アイテムの配置/表示サイズ

**対象機能**: プラン一覧ページ、予約フォームページ

**考慮すべき仕様の具体例**:
- ホテルプランカードが画面幅に応じて適切にレイアウトされる
- プラン画像が指定サイズで表示される（画像比率の維持）
- 必須項目に「必須」バッジが表示される
- 価格表示が正しいフォーマット（例: ¥12,000）で表示される
- モバイル表示時にレスポンシブデザインが適用される
- フォームラベルが文字切れせずに表示される

**Steps**:
1. プラン一覧ページ（`/ja/plans.html`）にアクセス
2. 各プランカードの表示を確認
   - プラン名が完全に表示されている
   - 価格表示が正常
   - 画像が正しく読み込まれている
3. ブラウザ幅を変更（1920px → 768px → 375px）
4. 各サイズでレイアウト崩れがないことを確認
5. 予約フォームに遷移
6. フォーム項目のラベルとバッジを確認
   - 「宿泊日 必須」
   - 「宿泊数 必須」
   - 「人数 必須」
   - 「氏名 必須」
   - 「確認のご連絡 必須」

**Expected Results**:
- すべての要素が仕様デザイン通りに配置されている
- レスポンシブデザインが正しく機能する
- 文字切れ・折り返し不良がない
- 高DPI環境でも表示が適切

**狙うバグ**:
- 仕様デザインと異なる配置
- レスポンシブ崩れ
- 折返し不良
- DPI違いで文字が切れる

---

### 1.2 エラー表示（正常系）
**テスト観点No.2**: エラーメッセージの適切性

**対象機能**: 予約フォームのバリデーション

**考慮すべき仕様の具体例**:
- 必須項目未入力時のエラーメッセージが表示される
- エラーメッセージで「何が問題か」「どうすればよいか」が明確
- フィールドごとにエラーが表示される（グローバルエラーではない）
- エラーメッセージが日本語で表示される（i18n対応）
- エラー時にフォーカスが該当フィールドに移動する

**Steps**:
1. 予約フォームにアクセス
2. すべての項目を空白のまま「予約内容を確認する」ボタンをクリック
3. 各フィールドのエラーメッセージを確認
4. 一部のフィールドのみ入力して再度送信
5. 未入力フィールドのみエラーが表示されることを確認

**Expected Results**:
- 「宿泊日を入力してください」のような明確なメッセージ
- 内部エラーコードが漏えいしていない
- 再試行手順が明確（フォーム修正可能）
- 複数エラー時もすべて表示される

**狙うバグ**:
- メッセージが曖昧（「エラーが発生しました」のみ）
- 内部コード漏えい（"ERR_001"など）
- 再試行手順不足（エラー後にフォームが使えない）

---

## 2. 入力テスト

### 2.1 文字種テスト
**テスト観点No.3**: 入力した文字種による仕様外の動作

**対象機能**: 氏名入力フィールド

**考慮すべき仕様の具体例**:
- ひらがな、カタカナ、漢字が入力可能
- 半角英数字が入力可能
- 特殊文字（記号）の扱い
- 全角スペース・半角スペースの扱い
- サロゲートペア文字（絵文字）の扱い

**Steps**:
1. 氏名フィールドに以下を順次入力してフォーム送信
   - ひらがな: 「やまだたろう」
   - カタカナ: 「ヤマダタロウ」
   - 漢字: 「山田太郎」
   - 半角英字: 「Yamada Taro」
   - 全角英字: 「Ｙａｍａｄａ Ｔａｒｏ」
   - 混在: 「山田Taro」
   - 特殊文字: 「山田・太郎」「山田＝太郎」
   - 絵文字: 「山田太郎😀」

**Expected Results**:
- 仕様で許可された文字種は正常に処理される
- 許可されない文字種はエラーメッセージが表示される
- システムエラー（500エラーなど）が発生しない

**狙うバグ**:
- 特殊文字でSQLインジェクション
- サロゲートペアでシステムクラッシュ
- バリデーション不足

---

### 2.2 文字数テスト（正常値）
**テスト観点No.4**: 仕様通りの文字数が入力可能

**対象機能**: 氏名入力フィールド

**考慮すべき仕様の具体例**:
- 最小文字数: 1文字（仕様確認必要）
- 最大文字数: 50文字（仕様確認必要）
- 通常使用範囲: 2〜20文字

**Steps**:
1. 氏名フィールドに以下を入力
   - 2文字: 「山田」
   - 10文字: 「山田太郎花子次郎三郎」
   - 20文字: 「山田太郎花子次郎三郎四郎五郎六郎」

**Expected Results**:
- すべて正常に入力・送信できる
- 文字数制限エラーが発生しない

---

### 2.3 文字数テスト（正常限界）
**テスト観点No.5**: 仕様の上限/下限文字数が入力可能

**対象機能**: 氏名入力フィールド

**考慮すべき仕様の具体例**:
- 最小境界値: 1文字（「山」）
- 最大境界値: 50文字（50文字の氏名）

**Steps**:
1. 氏名フィールドに1文字入力して送信
2. 氏名フィールドに50文字入力して送信

**Expected Results**:
- 境界値でも正常に処理される
- エラーが発生しない

---

### 2.4 文字数テスト（異常値）
**テスト観点No.6**: 入力できない文字数でエラー

**対象機能**: 氏名入力フィールド

**考慮すべき仕様の具体例**:
- 0文字（空白）
- 51文字（上限超過）
- 100文字（大幅超過）

**Steps**:
1. 氏名フィールドを空白のまま送信
2. 氏名フィールドに51文字入力して送信
3. 氏名フィールドに100文字入力して送信

**Expected Results**:
- 適切なエラーメッセージが表示される
- システムエラーが発生しない

**狙うバグ**:
- バリデーションなしでDBに保存されデータ切れ
- バッファオーバーフロー

---

### 2.5 数値テスト（正常値）
**テスト観点No.7**: 仕様通りの数値が入力可能

**対象機能**: 宿泊数、人数フィールド

**考慮すべき仕様の具体例**:
- 宿泊数: 1〜30泊（仕様確認必要）
- 人数: 1〜10名（仕様確認必要）

**Steps**:
1. 宿泊数に以下を入力
   - 1泊
   - 7泊
   - 14泊
2. 人数に以下を入力
   - 1名
   - 4名
   - 8名

**Expected Results**:
- すべて正常に入力・送信できる

---

### 2.6 数値テスト（異常値）
**テスト観点No.8**: 入力できない数値でエラー

**対象機能**: 宿泊数、人数フィールド

**考慮すべき仕様の具体例**:
- 負の数: -1
- 0（ゼロ）
- 上限超過: 31泊、11名
- 小数点: 1.5泊
- 文字列: 「三泊」

**Steps**:
1. 宿泊数に「0」を入力して送信
2. 宿泊数に「31」を入力して送信
3. 宿泊数に「1.5」を入力（ブラウザが許可する場合）
4. 人数に「0」を入力して送信
5. 人数に「11」を入力して送信

**Expected Results**:
- 適切なエラーメッセージが表示される
- 「1以上の整数を入力してください」など
- システムエラーが発生しない

**狙うバグ**:
- 負の数で計算エラー
- 0で割り算エラー
- 上限超過でDBエラー

---

### 2.7 未入力テスト
**テスト観点No.9**: 入力欄を空白のまま機能実行

**対象機能**: すべての必須項目

**考慮すべき仕様の具体例**:
- 宿泊日が未入力
- 宿泊数が未入力
- 人数が未入力
- 氏名が未入力
- 確認のご連絡が未選択

**Steps**:
1. 予約フォームにアクセス
2. すべての項目を未入力のまま「予約内容を確認する」をクリック
3. 個別に各項目のみ未入力にして送信を繰り返す

**Expected Results**:
- 必須項目未入力時に明確なエラーメッセージ
- フォーム送信がブロックされる
- エラー項目が視覚的に強調される（赤枠など）

---

## 3. 動作確認テスト

### 3.1 単機能テスト
**テスト観点No.10**: 各機能が仕様通りに動作

**対象機能**: プラン選択、予約フォーム送信

**考慮すべき仕様の具体例**:
- プラン一覧からプランを選択できる
- 選択したプランIDがパラメータに含まれる（`?plan-id=X`）
- フォーム送信後に確認画面に遷移する
- 入力内容が確認画面に表示される
- 戻るボタンで入力内容が保持される

**Steps**:
1. プラン一覧ページにアクセス
2. 任意のプラン（例: plan-id=0）を選択
3. URLパラメータを確認（`?plan-id=0`が含まれる）
4. フォームに正常値を入力
   - 宿泊日: 明日の日付
   - 宿泊数: 2泊
   - 人数: 2名
   - 氏名: 「山田太郎」
   - 確認のご連絡: 「メールでのご連絡」
5. 「予約内容を確認する」をクリック
6. 確認画面で入力内容を確認
7. 「戻る」ボタンをクリック
8. 入力内容が保持されているか確認

**Expected Results**:
- 各ステップが仕様通りに動作
- データが正しく引き継がれる
- エラーが発生しない

---

## 4. 状態遷移テスト

### 4.1 画面遷移テスト
**テスト観点No.11**: イベント発生により状態が変わる

**対象機能**: プラン選択 → 予約フォーム → 確認画面

**考慮すべき仕様の具体例**:
- プラン選択ボタンクリックで予約フォームに遷移
- フォーム送信で確認画面に遷移
- 確認画面から戻るとフォームに戻る
- 各遷移でデータが保持される

**Steps**:
1. プラン一覧ページから「プランを選択」をクリック
2. 予約フォームページに遷移することを確認
3. フォームに入力して送信
4. 確認画面に遷移することを確認
5. 「戻る」ボタンで予約フォームに戻る
6. 入力内容が保持されているか確認

**Expected Results**:
- 各遷移がスムーズに行われる
- データが適切に引き継がれる
- ブラウザの戻るボタンでも正常動作

---

### 4.2 経時変化テスト
**テスト観点No.12**: イベント発生中や発生後の状態

**対象機能**: フォーム送信中の状態

**考慮すべき仕様の具体例**:
- フォーム送信中にボタンが無効化される
- 二重送信が防止される
- ローディング表示が出る
- タイムアウト時の処理

**Steps**:
1. 予約フォームに入力
2. 「予約内容を確認する」をクリック
3. 即座に再度クリックを試みる
4. ボタンの状態を確認
5. ネットワークを意図的に遅延させて再テスト

**Expected Results**:
- 送信中はボタンが無効化される
- 二重送信が発生しない
- ローディング表示が適切に出る

**狙うバグ**:
- 二重送信でデータ重複
- ローディング表示なしでユーザー混乱

---

### 4.3 画面遷移（データ保持）
**テスト観点No.13**: 画面遷移時のデータ保持

**対象機能**: 予約フォーム → 確認画面 → 戻る

**考慮すべき仕様の具体例**:
- 確認画面から戻った時にフォームデータが保持される
- ブラウザの戻るボタンでもデータ保持
- セッションストレージ/ローカルストレージの利用有無

**Steps**:
1. フォームに入力
2. 確認画面に進む
3. 「戻る」ボタンで戻る → データ保持確認
4. 再度確認画面に進む
5. ブラウザの戻るボタンで戻る → データ保持確認

**Expected Results**:
- どちらの方法でもデータが保持される
- 再入力の手間がない

---

## 5. 変更・反映・設定保持テスト

### 5.1 初期値テスト
**テスト観点No.14**: インストール時/起動時の設定・表示

**対象機能**: 予約フォーム初回表示

**考慮すべき仕様の具体例**:
- 宿泊日のデフォルト値（空白 or 明日の日付）
- 宿泊数のデフォルト値（1泊）
- 人数のデフォルト値（1名）
- ログイン状態での初期表示（ユーザー名自動入力など）

**Steps**:
1. ログアウト状態で予約フォームにアクセス
2. 各フィールドの初期値を確認
3. ログイン
4. 再度予約フォームにアクセス
5. ログイン状態での初期値を確認

**Expected Results**:
- 適切なデフォルト値が設定されている
- ログイン状態では氏名が自動入力される（仕様次第）

---

### 5.2 変更・反映テスト
**テスト観点No.15**: 変更がどの機能/画面に反映されるか

**対象機能**: フォーム入力内容の反映

**考慮すべき仕様の具体例**:
- フォーム入力内容が確認画面に反映される
- プラン変更が料金計算に反映される
- 人数変更が料金に影響する（仕様次第）

**Steps**:
1. フォームに入力
2. 確認画面で入力内容を確認
3. 戻って内容を変更
4. 再度確認画面で変更内容を確認

**Expected Results**:
- すべての変更が正しく反映される
- 古いデータが残らない

---

### 5.3 キャンセルテスト
**テスト観点No.17**: キャンセル時の設定

**対象機能**: 予約キャンセル、フォーム入力キャンセル

**考慮すべき仕様の具体例**:
- 確認画面から戻った時にデータが保持される（キャンセルではない）
- ブラウザを閉じた場合のデータクリア

**Steps**:
1. フォームに入力
2. 確認画面に進む
3. 「戻る」で戻る
4. データが保持されているか確認
5. ブラウザを閉じて再度アクセス
6. データがクリアされているか確認

**Expected Results**:
- 戻る操作ではデータ保持
- ブラウザクローズでデータクリア

---

## 6. 機能組合せテスト

### 6.1 因子組合せテスト
**テスト観点No.18**: 複数因子の組み合わせ

**対象機能**: 予約フォーム全体

**考慮すべき仕様の具体例**:
- プランID × 宿泊日 × 宿泊数 × 人数 × 連絡方法
- 境界値の組み合わせ
- 異常値の組み合わせ

**ペアワイズ法での組み合わせ例**:

| No | プランID | 宿泊日 | 宿泊数 | 人数 | 連絡方法 |
|----|---------|--------|--------|------|---------|
| 1  | 0       | 明日   | 1泊    | 1名  | メール  |
| 2  | 0       | 1週間後 | 7泊   | 4名  | 電話    |
| 3  | 1       | 明日   | 3泊    | 2名  | 不要    |
| 4  | 1       | 2週間後 | 1泊   | 10名 | メール  |

**Steps**:
1. 上記の組み合わせでそれぞれフォーム送信
2. すべて正常に処理されることを確認

**Expected Results**:
- どの組み合わせでも正常動作
- 組み合わせ特有のバグが発生しない

**狙うバグ**:
- 特定の組み合わせでのみ発生するバグ
- 因子間の相互作用による不具合

---

## 7. 同時実行・割込みテスト

### 7.1 複数アカウント同時実行
**テスト観点No.20**: 処理中に別環境から操作

**対象機能**: 同一プランの同時予約

**考慮すべき仕様の具体例**:
- 2つのブラウザで同じプランを同時に予約
- 在庫管理がある場合の排他制御
- セッション管理の独立性

**Steps**:
1. ブラウザAで予約フォームを開く
2. ブラウザBで同じプランの予約フォームを開く
3. 両方で同時に入力・送信
4. 結果を確認

**Expected Results**:
- 両方とも正常に予約できる（在庫がある場合）
- または、先着順で処理される
- セッションが混在しない

**狙うバグ**:
- 排他制御不足でダブルブッキング
- セッション混在

---

### 7.2 別デバイスからの操作
**テスト観点No.21**: 処理中に別デバイスから操作

**対象機能**: ログイン状態での同時操作

**考慮すべき仕様の具体例**:
- PC + スマホで同じアカウントでログイン
- 一方で予約中にもう一方で操作

**Steps**:
1. PCでログインして予約フォームを開く
2. スマホで同じアカウントでログイン
3. PCで予約を進行中にスマホで別の操作
4. 挙動を確認

**Expected Results**:
- セッション管理が適切
- 予期しないログアウトが発生しない

---

## 8. 排他処理・禁則テスト

### 8.1 禁則条件テスト
**テスト観点No.23**: 禁則条件に合致した操作ができない

**対象機能**: 予約制約

**考慮すべき仕様の具体例**:
- 過去の日付を宿泊日に設定できない
- 当日予約の可否（仕様確認必要）
- 最大宿泊数を超える予約
- チェックイン日 > チェックアウト日

**Steps**:
1. 宿泊日に昨日の日付を入力しようとする
2. 宿泊日に今日の日付を入力
3. 宿泊数に上限を超える値を入力

**Expected Results**:
- 禁則条件に該当する操作はエラー
- 明確なエラーメッセージ

**狙うバグ**:
- 禁則チェック漏れ
- 過去日付で予約できてしまう

---

## Test Execution Matrix

### テスト優先度

| Priority | テストシナリオ | 実施タイミング |
|----------|--------------|--------------|
| P0 (必須) | 1.1, 1.2, 2.7, 3.1, 4.1, 8.1 | 毎回リリース前 |
| P1 (高) | 2.1-2.6, 4.2, 4.3, 5.1 | リリース前 |
| P2 (中) | 5.2, 5.3, 6.1 | 機能追加時 |
| P3 (低) | 7.1, 7.2 | 四半期ごと |

---

## Test Data

### 正常値テストデータ

```javascript
// 正常パターン1
{
  plan_id: 0,
  reserve_date: '2025-10-24', // 明日
  reserve_term: 2,
  head_count: 2,
  username: '山田太郎',
  contact: 'email'
}

// 正常パターン2
{
  plan_id: 1,
  reserve_date: '2025-10-30',
  reserve_term: 7,
  head_count: 4,
  username: 'Yamada Taro',
  contact: 'phone'
}
```

### 境界値テストデータ

```javascript
// 最小値
{
  reserve_term: 1,
  head_count: 1,
  username: '山' // 1文字
}

// 最大値
{
  reserve_term: 30,
  head_count: 10,
  username: 'あ'.repeat(50) // 50文字
}
```

### 異常値テストデータ

```javascript
// 異常パターン
{
  reserve_date: '2024-01-01', // 過去日付
  reserve_term: 0, // ゼロ
  head_count: -1, // 負の数
  username: '', // 空白
  contact: null // 未選択
}
```

---

## Automation Strategy

### 自動化対象
- P0, P1のシナリオ
- 回帰テスト
- データ駆動テスト（複数パターン）

### 自動化ツール
- **Othello + Playwright MCP**
- Jest（テストランナー）

### 実行頻度
- コミット時: P0シナリオ
- プルリクエスト時: P0 + P1
- リリース前: 全シナリオ

---

## Known Issues & Risks

### 既知の制約
- ログイン機能の詳細仕様が未確認
- プランの在庫管理仕様が不明
- 決済フロー（確認画面以降）が未確認

### リスク
- 実環境でのパフォーマンステスト未実施
- 負荷テスト未実施
- セキュリティテスト（XSS, SQLインジェクション）未実施

---

## Appendix

### 参考資料
- テスト観点リスト（簡易版）
- Othello実装例: `demo-hotel-complete.js`

### 更新履歴
- 2025-10-23: 初版作成（23項目の観点ベース）
